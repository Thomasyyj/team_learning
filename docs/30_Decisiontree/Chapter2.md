# Chapter2: Ensemble mode

## 1. ä¸ºä½•é›†æˆ

é¦–å…ˆæˆ‘ä»¬å›é¡¾ä¸€ä¸‹æœºå™¨å­¦ä¹ çš„æ•´ä¸ªè¿‡ç¨‹ï¼šæˆ‘ä»¬åœ¨æœ‰é™çš„æ•°æ®ä¸Šè®­ç»ƒæ¨¡å‹ï¼Œå†ç”¨æ¨¡å‹å»é¢„æµ‹æ–°çš„æ•°æ®ï¼Œå¹¶æœŸæœ›åœ¨æ–°çš„æ•°æ®ä¸Šèƒ½å¤Ÿå¾—åˆ°è¾ƒä½çš„é¢„æµ‹æŸå¤±ã€‚è¿™é‡Œçš„é¢„æµ‹æŸå¤±å¯ä»¥æœ‰å¾ˆå¤šç§ï¼šå‡æ–¹è¯¯å·®ï¼Œé”™è¯¯ç‡ç­‰ç­‰ã€‚é‚£ä¹ˆæˆ‘ä»¬é¢„æµ‹æ•°æ®çš„æŸå¤±æ˜¯ä»ä½•è€Œæ¥çš„å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜ç›´è§‚ä¸Šå¹¶ä¸å¥½ç›´æ¥åšè§£ç­”ï¼Œæˆ‘ä»¬éœ€è¦ä»æ•°å­¦è¯­è¨€åŠ ä»¥æè¿°ã€‚

é¦–å…ˆå®šä¹‰æ•°æ®ï¼Œå¯¹äºå®é™…é—®é¢˜ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå®ƒæ€»æ˜¯ç”±ä¸€ä¸ªåˆ†å¸ƒ$p$å¾—åˆ°çš„
$$
\textbf{X}_1,\textbf{X}_2,...,\textbf{X}_n\sim p(\textbf{X})
$$
è¿™äº›æ ·æœ¬å¯¹åº”çš„æ ‡ç­¾æ˜¯é€šè¿‡ä¸€ä¸ªæ¨¡å‹$f$å’Œå™ªå£°$\epsilon$å¾—åˆ°çš„ï¼Œå³ï¼š
$$
y_i = f(\textbf{X}_i)+\epsilon_i,i\in\{1,2,...,n\}
$$
å…¶ä¸­æˆ‘ä»¬å‡è®¾å™ªå£°çš„å‡å€¼ä¸º0æ–¹å·®ä¸º$\sigma^2$ ã€‚ç„¶åæœ‰äº†è®­ç»ƒæ•°æ®é›†$D=\{(\textbf{X}_1,y_1), (\textbf{X}_2,y_2),...,(\textbf{X}_n,y_n)\}$ä¹‹åï¼Œæˆ‘ä»¬å¸Œæœ›å­¦ä¹ ä¸€ä¸ª$\hat{f}$æ¥é¢„æµ‹æœªè§è¿‡çš„æ ·æœ¬ï¼Œç„¶åä½¿å¾—æŸå¤±å°½å¯èƒ½å°ã€‚

è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œç”±äºå¾€å¾€è®­ç»ƒé›†æ˜¯ä»æ‰€æœ‰æ ·æœ¬ä¸­é‡‡æ ·è€Œæ¥çš„ï¼Œæˆ‘ä»¬å­¦ä¹ çš„æ¨¡å‹$\hat{f}$å®é™…ä¹Ÿæ˜¯ä»æ€»ä½“åˆ†å¸ƒäº§ç”Ÿçš„éšæœºæœ‰é™åˆ†å¸ƒä¸­å­¦å‡ºæ¥çš„ï¼Œæˆ‘ä»¬ç”¨$\hat{f}_D$æ¥å¼ºè°ƒè¿™ä¸ªéšæœºåˆ†å¸ƒDã€‚ä»¥å‡æ–¹è¯¯å·®ä¸ºä¾‹ï¼Œç”±äºDæ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œæˆ‘ä»¬æœ¬è´¨ä¸Šä¼˜åŒ–çš„æŸå¤±æ˜¯$L=\mathbb{E}_D(y-\hat{f}_D(\tilde{\textbf{X}}))^2$ ï¼Œè¿™ä¸ªè¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›æŒ‰ç…§éšæœºåˆ†å¸ƒï¼ˆç”±ç»™å®šçš„æ€»ä½“åˆ†å¸ƒé‡‡æ ·è€Œç”Ÿæˆï¼‰äº§ç”Ÿçš„æ•°æ®è®­ç»ƒå‡ºçš„æ¨¡å‹ï¼Œåœ¨çœŸå®çš„å€¼ä¸Šæœ‰è¾ƒå¥½çš„é¢„æµ‹èƒ½åŠ›ï¼Œå³è¾ƒå¥½çš„æ³›åŒ–èƒ½åŠ›ã€‚

ç”¨æ•°å­¦è¯­è¨€æè¿°å¥½äº†æŸå¤±ä¹‹åï¼Œæˆ‘ä»¬æ¥åˆ†è§£ä¸€ä¸‹è¿™ä¸ªæŸå¤±ï¼Œçœ‹çœ‹è¿™ä¸ªæŸå¤±æ˜¯ç”±ä»€ä¹ˆæ„æˆçš„ï¼š
$$
\begin{split}
\begin{aligned}
L(\hat{f}) &= \mathbb{E}_D(y-\hat{f}_D)^2\\
&= \mathbb{E}_D(f+\epsilon-\hat{f}_D+\mathbb{E}_D[\hat{f}_{D}]-\mathbb{E}_D[\hat{f}_{D}])^2 \\
&= \mathbb{E}_D[(f-\mathbb{E}_D[\hat{f}_{D}])+(\mathbb{E}_D[\hat{f}_{D}]-\hat{f}_D)+\epsilon]^2 \\
&= \mathbb{E}_D[(f-\mathbb{E}_D[\hat{f}_{D}])^2] + \mathbb{E}_D[(\mathbb{E}_D[\hat{f}_{D}]-\hat{f}_D)^2] + \mathbb{E}_D[\epsilon^2]\\
&+2\mathbb{E}_D[\epsilon (f-\mathbb{E}_D[\hat{f}_{D}])]+2\mathbb{E}_D[\epsilon(\mathbb{E}_D[\hat{f}_{D}]-\hat{f}_D)^2]+2\mathbb{E}_D[(f-\mathbb{E}_D[\hat{f}_{D}])(\mathbb{E}_D[\hat{f}_{D}]-\hat{f}_D)] \\
&= \mathbb{E}_D[(f-\mathbb{E}_D[\hat{f}_{D}])^2] + \mathbb{E}_D[(\mathbb{E}_D[\hat{f}_{D}]-\hat{f}_D)^2] + \mathbb{E}_D[\epsilon^2] \\
&= [f-\mathbb{E}_D[\hat{f}_{D}]]^2 + \mathbb{E}_D[(\mathbb{E}_D[\hat{f}_{D}]-\hat{f}_D)^2] + \sigma^2
\end{aligned}
\end{split}
$$
æ³¨æ„ï¼Œå…¶ä¸­ç”±äº$E[\epsilon]$ä¸ºç™½å™ªå£°å§‹ç»ˆä¸ºé›¶ï¼Œ$\hat{f}_D$åœ¨å»è¿‡æœŸæœ›åå˜æˆå¸¸æ•°ï¼Œå³$\mathbb{E}_D[\hat{f}_{D}]$ä¸ºå¸¸æ•°ï¼Œæ­¤å¤–ï¼š
$$
\begin{split}
\begin{aligned}
&\mathbb{E}_D[(f-\mathbb{E}_D[\hat{f}_{D}])(\mathbb{E}_D[\hat{f}_{D}]-\hat{f}_D)]\\
&=(f-\mathbb{E}_D[\hat{f}_{D}])\{\mathbb{E}_D[(\mathbb{E}_D[\hat{f}_{D}]-\hat{f}_D)]\}\\
&=(f-\mathbb{E}_D[\hat{f}_{D}])\{\mathbb{E}_D[\hat{f}_{D}]-\mathbb{E}_D[\hat{f}_{D}]\}\\
&=0
\end{aligned}
\end{split}
$$
å› æ­¤åœ¨ç¬¬å››ä¸ªç­‰å·è¿™é‡Œæ‰€æœ‰çš„äº¤å‰é¡¹å‡ä¸º0ï¼Œæˆ‘ä»¬èƒ½å¾—åˆ°æœ€ç»ˆçš„ç»“æœ
$$
L(\hat{f})=[f-\mathbb{E}_D[\hat{f}_{D}]]^2 + \mathbb{E}_D[(\mathbb{E}_D[\hat{f}_{D}]-\hat{f}_D)^2] + \sigma^2\\
æ³›åŒ–è¯¯å·®=åå·®+æ–¹å·®+å™ªå£°
$$
ç”±ä¸Šå¼å­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒæŸå¤±å¯ä»¥åˆ†è§£æˆä¸‰ä¸ªéƒ¨åˆ†ï¼šæ¨¡å‹çš„é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„åå·®ï¼Œæ¨¡å‹æœ¬èº«çš„æ–¹å·®ä»¥åŠæ•°æ®ä¸­çš„åŸå§‹å™ªå£°ã€‚ç¬¬ä¸€é¡¹æ¨¡å‹é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„åå·®èƒ½å¤Ÿåæ˜ æ¨¡å‹é¢„æµ‹ä¸çœŸå®å€¼çš„åç¦»ç¨‹åº¦ï¼Œåˆ»ç”»äº†æ¨¡å‹æœ¬èº«çš„æ‹Ÿåˆèƒ½åŠ›ã€‚ç¬¬äºŒé¡¹æ¨¡å‹çš„æ–¹å·®ååº”äº†æ¨¡å‹çš„æŠ—å¹²æ‰°èƒ½åŠ›ï¼Œæ³¨æ„è¿™é‡Œçš„æ–¹å·®æ˜¯å…³äºéšæœºåˆ†å¸ƒ$D$çš„ï¼Œåº¦é‡çš„æ˜¯ä¸åŒè®­ç»ƒé›†çš„å˜åŠ¨å¯¹å­¦ä¹ æ€§èƒ½çš„å½±å“ã€‚ç¬¬ä¸‰é¡¹ä¸ºä¸é¿å…çš„æ•°æ®æœ¬èº«äº§ç”Ÿçš„åŸå§‹å™ªå£°ï¼Œè¿™ä¸ªæˆ‘ä»¬æ— æ³•é€šè¿‡ä¼˜åŒ–æ¨¡å‹æ¥é™ä½ã€‚è¿™ç§åˆ†è§£ç»™äº†æˆ‘ä»¬ä¸€ç§ä¼˜åŒ–æ¨¡å‹çš„æ€è·¯ï¼ŒåŒ…å«ä¸¤ä¸ªæ–¹å‘ï¼š1.ä¼˜åŒ–é™ä½æ¨¡å‹é¢„æµ‹çš„åå·®ã€‚2.ä¼˜åŒ–é™ä½æ¨¡å‹æœ¬èº«çš„æ–¹å·®ã€‚

è¿™é‡Œéœ€è¦æåˆ°æ–¹å·®-åå·®å›°å¢ƒï¼Œè¿‡äºç®€å•çš„æ¨¡å‹ï¼ˆæ¯”å¦‚çº¿æ€§å›å½’ï¼‰è™½ç„¶æ¨¡å‹æœ¬èº«æ–¹å·®è¾ƒå°ï¼Œä½†æ˜¯é¢„æµ‹èƒ½åŠ›ä¸å¼ºï¼Œä¼šäº§ç”Ÿè¾ƒå¤§çš„åå·®ã€‚è€Œè¿‡äºå¤æ‚çš„å­¦ä¹ å™¨è™½ç„¶æ‹Ÿåˆèƒ½åŠ›å¾ˆæµ…ï¼Œåå·®å¾ˆå°ï¼Œä½†æ˜¯ç”±äºç»å¸¸ä¼šå­¦åˆ°å†—ä½™çš„ä¿¡æ¯å’Œå™ªå£°ï¼Œæ¨¡å‹æœ¬èº«çš„æ–¹å·®ä¼šè¾ƒå¤§ï¼Œè¿™é‡Œç”¨ä¸‹å›¾å¯ä»¥ç›´è§‚çš„çœ‹å‡ºå¯¹äºå•ä¸ªå­¦ä¹ å™¨ï¼Œé™ä½æ–¹å·®åŒæ—¶é™ä½åå·®æ¯”è¾ƒå›°éš¾ã€‚

![](material/2.1.png)

ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼šè®­ç»ƒç¨‹åº¦ä¸è¶³æ—¶ï¼Œå­¦ä¹ å™¨çš„æ‹Ÿåˆèƒ½åŠ›ä¸å¤Ÿå¼ºï¼Œè®­ç»ƒæ•°æ®çš„æ‰°åŠ¨ä¸è¶³ä»¥ä½¿å­¦ä¹ å™¨äº§ç”Ÿæ˜¾è‘—å˜åŒ–ï¼Œåå·®å°†ä¸»å¯¼æ³›åŒ–é”™è¯¯ç‡ã€‚éšç€è®­ç»ƒç¨‹åº¦åŠ æ·±ï¼Œå­¦ä¹ å™¨çš„æ‹Ÿåˆèƒ½åŠ›é€æ¸å¢å¼ºï¼Œè®­ç»ƒæ•°æ®å‘ç”Ÿçš„æ‰°åŠ¨é€æ¸èƒ½å¤Ÿè¢«å­¦ä¹ å™¨å­¦åˆ°ï¼Œæ–¹å·®å°†ä¸»å¯¼æ³›åŒ–é”™è¯¯ç‡ã€‚è®­ç»ƒç¨‹åº¦å……è¶³åï¼Œå­¦ä¹ å™¨çš„æ‹Ÿåˆèƒ½åŠ›å·²ç»éå¸¸å¼ºï¼Œè®­ç»ƒæ•°æ®å‘ç”Ÿçš„è½»å¾®æ‰°åŠ¨éƒ½ä¼šå¯¼è‡´å­¦ä¹ å™¨å‘ç”Ÿæ˜¾è‘—å˜åŒ–ã€‚è®­ç»ƒæ•°æ®éå…¨å±€çš„ç‰¹å¾å¦‚æœè¢«å­¦ä¹ å™¨å­¦åˆ°äº†ï¼Œå°†å‘ç”Ÿè¿‡æ‹Ÿåˆã€‚è¿™æ˜¯æ–¹å·®-åå·®å›°å¢ƒåœ¨è¥¿ç“œä¹¦ä¸­çš„å…·ä½“è¡¨è¿°ã€‚

é‚£ä¹ˆå¾ˆè‡ªç„¶çš„æƒ³åˆ°ï¼Œæ—¢ç„¶åŒæ—¶é™ä½å•ä¸ªæ¨¡å‹çš„åå·®ä¸æ–¹å·®æ¯”è¾ƒå›°éš¾ï¼Œèƒ½å¦è¿ç”¨å¤šä¸ªæ¨¡å‹é›†æˆæ¥é™ä½åå·®æˆ–è€…æ–¹å·®å‘¢ï¼Ÿæ›´æ˜ç¡®æ¥è¯´ï¼šæˆ‘ä»¬å¸Œæœ›åˆ©ç”¨å¤šä¸ªä½åå·®çš„å­¦ä¹ å™¨è¿›è¡Œé›†æˆæ¥é™ä½æ¨¡å‹çš„æ–¹å·®ï¼Œæˆ–è€…åˆ©ç”¨å¤šä¸ªä½æ–¹å·®å­¦ä¹ å™¨è¿›è¡Œé›†æˆæ¥é™ä½æ¨¡å‹çš„åå·®ï¼Œè€Œbaggingæ–¹æ³•å’Œboostingæ–¹æ³•å°±åˆ†åˆ«æ˜¯è¿™ä¸¤ç§æ€è·¯çš„å…·ä½“æ¡†æ¶ã€‚

## 2. baggingä¸boosting

é¦–å…ˆæˆ‘ä»¬æ¥ä»‹ç»baggingï¼Œbaggingæ˜¯ä¸€ç§å¹¶è¡Œçš„é›†æˆæ–¹æ³•ï¼Œå…¨ç§°æ˜¯bootstrap aggregatingï¼Œå³åŸºäºbootstrapæŠ½æ ·æœ‰æ”¾å›é‡‡æ ·çš„èšåˆç®—æ³•ï¼Œå…¸å‹ä¾‹å­å°±æ˜¯éšæœºæ£®æ—random forestã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è¯¦ç»†è§£é‡Šï¼ŒbootstrapæŠ½æ ·æŒ‡ä»æ ·æœ¬é›†åˆä¸­æœ‰æ”¾å›åœ°è¿›è¡Œé‡‡æ ·ï¼Œå‡è®¾æ•°æ®é›†æ ·æœ¬å®¹é‡ä¸º$n$ä¸”æœ‰$M$ä¸ªåŸºå­¦ä¹ å™¨ï¼Œå¯¹äºæ¯ä¸ªåŸºå­¦ä¹ å™¨æˆ‘ä»¬æœ‰æ”¾å›åœ°æŠ½å–$n$ä¸ªæ ·æœ¬ï¼Œç”Ÿæˆ$M$ç»„æ•°æ®é›†ï¼Œæ¯ä¸ªåŸºå­¦ä¹ å™¨åˆ†åˆ«åœ¨è¿™äº›æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œå†å°†æœ€ç»ˆçš„ç»“æœæ±‡æ€»è¾“å‡ºã€‚è¿™å°±æ˜¯baggingç®—æ³•çš„åŸºæœ¬æµç¨‹ã€‚

å¯¹äºbootstrapï¼Œæˆ‘ä»¬æ¥ç€æ¥è®¤è¯†ä¸€ä¸‹è¿™æ ·æŠ½æ ·ä¼šæœ‰ä»€ä¹ˆæ ·çš„æ€§è´¨ã€‚å¯¹äºæŠ½æ ·ï¼Œæˆ‘ä»¬å…³å¿ƒä»¥ä¸‹è¿™ä¸¤ç‚¹ï¼šå•ä¸ªæ ·æœ¬æœ‰å¤šå¤§å¯èƒ½æ€§å…¥é€‰ï¼Ÿæ— é™æ¬¡æŠ½æ ·åæœ‰å¤šå°‘ä¸åŒçš„æ ·æœ¬ä¼šåŒ…å«åœ¨è®­ç»ƒé›†å†…ï¼Ÿå¯¹äºç¬¬ä¸€ç‚¹ï¼Œåœ¨næ¬¡é‡‡æ ·ä¸‹ï¼Œä¸€ä¸ªæ ·æœ¬æ²¡æœ‰å…¥é€‰çš„æ¦‚ç‡ä¸º$(1-\frac{1}{n})^n$ï¼Œé‚£ä¹ˆå…¥é€‰çš„æ¦‚ç‡ä¸º$1-(1-\frac{1}{n})^n$ï¼Œå½“$n\rightarrow \infty$æ—¶æœ€ç»ˆå•ä¸ªæ ·æœ¬å…¥é€‰çš„æ¦‚ç‡ä¸º$1-e^{-1}$ã€‚å¯¹äºç¬¬äºŒç‚¹ï¼Œå¯ä»¥è¯æ˜æœ€ç»ˆæœŸæœ›ä»ç„¶æ˜¯$1-e^{-1}$ã€‚

ç»ƒä¹ ï¼šå‡è®¾æˆ‘ä»¬æœ‰100ä¸ªæ ·æœ¬è¿›è¡Œbootstrapï¼Œæ±‚å°†æ‰€æœ‰æ ·æœ¬å…¨éƒ¨æŠ½ä¸­çš„è½®æ•°æœŸæœ›ä»¥åŠæ–¹å·®çš„boundã€‚

å‡è®¾æŠ½ä¸­æ‰€æœ‰ä¸åŒ100ä¸ªä¸åŒæ ·æœ¬éœ€è¦$T$è½®ï¼Œç¬¬$T_i$è½®æ—¶æ°å¥½æŠ½ä¸­ç¬¬100ä¸ªä¸åŒçš„æ ·æœ¬ï¼Œ$T_{i-1}$è½®æ—¶æŠ½ä¸­99ä¸ªä¸åŒæ ·æœ¬ï¼Œé‚£ä¹ˆ$T_1$æ—¶æŠ½ä¸­ç¬¬ä¸€ä¸ªä¸åŒæ ·æœ¬ï¼Œæˆ‘ä»¬éœ€è¦æ±‚$E[T]$

![](material/2.2.svg)

å…¶ä¸­$H_n$ä¸ºharmonic seriesï¼Œé‚£ä¹ˆå½“n=100æ—¶éœ€è¦å¤§æ¦‚518æ¬¡å·¦å³å–æ ·æ‰èƒ½å¤Ÿå®Œæˆï¼Œç„¶åæ–¹å·®çš„boundå¯ä»¥ç”¨é©¬å°”ç§‘å¤«ä¸ç­‰å¼æ¥æ±‚å¾—ï¼š

![](material/2.3.svg)

è¿™ä¹ˆæŠ½æ ·æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼ŸåŸå› åœ¨äºæ•°æ®é›†æ˜¯ä»æ€»ä½“åˆ†å¸ƒ$P(X)$æŠ½æ ·å¾—åˆ°çš„ï¼Œæ­¤æ—¶æ•°æ®é›†æ„æˆäº†æ ·æœ¬çš„ç»éªŒåˆ†å¸ƒ$\tilde{p}(X)$ï¼Œç”±äºé‡‡ç”¨äº†æ”¾å›é‡‡æ ·ï¼Œé‚£ä¹ˆ$M$ä¸ªæ•°æ®é›†ä¸­æ¯ä¸€ç»„æ–°æ ·æœ¬éƒ½æ¥è‡ªç»éªŒåˆ†å¸ƒ$\tilde{P}(X)$ã€‚åŒæ—¶ç”±å¤§æ•°å®šå¾‹å¯çŸ¥ï¼Œå½“æ ·æœ¬é‡$n\rightarrow \infty$æ—¶ï¼Œç»éªŒåˆ†å¸ƒä¼šæ”¶æ•›åˆ°æ€»ä½“åˆ†å¸ƒï¼Œå› æ­¤å¤§æ ·æœ¬ä¸‹çš„æ–°æ•°æ®é›†è¿‘ä¼¼æŠ½æ ·è‡ªæ€»ä½“åˆ†å¸ƒã€‚

å¦å¤–æˆ‘ä»¬æ¥çœ‹çœ‹è¿™æ ·æŠ½æ ·æ˜¯å¦‚ä½•é™ä½æ–¹å·®çš„å‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬å¤„ç†å›å½’ä»»åŠ¡ï¼Œæ¯ä¸ªåŸºå­¦ä¹ å™¨è¾“å‡ºå€¼$y^{(i)}$çš„æ–¹å·®ä¸º$\sigma^2$ï¼ŒåŸºå­¦ä¹ å™¨ä¸¤ä¸¤ä¹‹é—´ç›¸å…³ç³»æ•°ä¸º$\rho$,åˆ™å¯ä»¥è®¡ç®—é›†æˆæ¨¡å‹è¾“å‡ºçš„æ–¹å·®ä¸º
$$
\begin{split}
\begin{aligned}
Var(\hat{y})&=Var(\frac{\sum_{i=1}^My^{(i)}}{M})\\
&= \frac{1}{M^2}[\sum_{i=1}^MVar(y^{(i)})+\sum_{i\neq j}Cov(y^{(i)},y^{(j)})]\\
&= \frac{1}{M^2}[M\sigma^2+M(M-1)\rho\sigma^2]\\
&= \rho\sigma^2 + (1-\rho)\frac{\sigma^2}{M}
\end{aligned}
\end{split}
$$
ç›´è§‚ç†è§£è¿™ä¸ªè¾“å‡ºç»“æœï¼šå°±æ˜¯æŠŠç›¸å…³ç³»æ•°$\rho$ä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œæœ€ç»ˆçš„æ–¹å·®åœ¨$[\sigma^2,\frac{\sigma^2}{M}]$åŒºé—´å†…ï¼Œå½“$\rho$å–å€¼ä¸º1æ—¶ï¼ˆæ‰€æœ‰æ¨¡å‹ä¹‹é—´è¾“å‡ºå®Œå…¨ä¸€è‡´ï¼‰ï¼Œæ–¹å·®åŒåŸæ¥æœªé›†æˆæ—¶ç›¸åŒã€‚ç›¸å…³æ€§ç³»æ•°è¶Šä½ï¼Œæ¨¡å‹æ–¹å·®è¶Šä½ã€‚bootstrapçš„æ”¾å›æŠ½æ ·ç‰¹æ€§ä¿è¯äº†æ¨¡å‹ä¸¤ä¸¤ä¹‹é—´å¾ˆå¯èƒ½æœ‰ä¸€äº›æ ·æœ¬ä¸ä¼šåŒæ—¶åŒ…å«ï¼Œè¿™ä½¿æ¨¡å‹çš„ç›¸å…³ç³»æ•°å¾—ä»¥é™ä½ï¼Œä»è€Œé›†æˆçš„æ–¹å·®éšç€æ¨¡å‹ç›¸å…³æ€§çš„é™ä½è€Œå‡å°ã€‚å¦‚æœæƒ³è¦è¿›ä¸€æ­¥å‡å°‘æ¨¡å‹ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹åŸºå­¦ä¹ å™¨è¿›è¡Œè¿›ä¸€æ­¥çš„è®¾è®¡ï¼Œåé¢ç¬¬å››éƒ¨åˆ†ä¼šè¯¦ç»†ä»‹ç»ã€‚

éšåæˆ‘ä»¬æ¥ä»‹ç»booostingï¼Œboostingæ˜¯ä¸€ç§ä¸²è¡Œé›†æˆæ–¹æ³•ï¼Œå‡è®¾ç¬¬ğ‘–iä¸ªåŸºæ¨¡å‹çš„è¾“å‡ºæ˜¯$\hat{f}^{(i)}(\mathbf{X})$ï¼Œåˆ™æ€»ä½“æ¨¡å‹çš„è¾“å‡ºä¸º$\sum_{i=1}^M\alpha_i\hat{f}^{(i)}(\mathbf{X})$ï¼Œboostingç®—æ³•åœ¨æ‹Ÿåˆç¬¬$T$ä¸ªå­¦ä¹ å™¨æ—¶ï¼Œå·²ç»è·å¾—äº†å‰$ğ‘‡âˆ’1$ä¸ªå­¦ä¹ å™¨çš„é›†æˆè¾“å‡º$\sum_{i=1}^{T-1}\alpha_i\hat{f}^{(i)}(\mathbf{X})$ï¼Œå¯¹äºæŸå¤±å‡½æ•°$L(y,\hat{y})$ï¼Œå½“å‰è½®éœ€è¦ä¼˜åŒ–çš„ç›®æ ‡å³ä¸ºä½¿å¾—$L(y,\alpha_{T}\hat{f}^{(T)}(\mathbf{X})+\sum_{i=1}^{T-1}\alpha_i\hat{f}^{(i)}(\mathbf{X}))$æœ€å°åŒ–ã€‚éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œå½“å‰è½®æ‰€æœ‰éœ€è¦ä¼˜åŒ–çš„å‚æ•°ä¸€èˆ¬è€Œè¨€éƒ½ä¼šè•´è—åœ¨$\alpha_{T}\hat{f}^{(T)}$ä¸­ï¼Œä¸åŒçš„æ¨¡å‹ä¼šå¯¹$\alpha_{T}\hat{f}^{(T)}$æå‡ºçš„ä¸åŒå‡è®¾ã€‚æ­¤å¤–ï¼Œç”±äºä¼˜åŒ–æŸå¤±åœ¨ç»éªŒåˆ†å¸ƒä¸æ€»ä½“åˆ†å¸ƒç›¸å·®ä¸å¤šçš„æ—¶å€™ç­‰ä»·äºä¼˜åŒ–äº†æ¨¡å‹çš„åå·®ï¼Œå› æ­¤å¤šä¸ªæ¨¡å‹é›†æˆåç›¸è¾ƒäºå•ä¸ªæ¨¡å‹çš„é¢„æµ‹èƒ½å¤Ÿä½¿å¾—åå·®é™ä½ã€‚æˆ‘ä»¬å°†åœ¨åé¢çš„ç« èŠ‚å°†è¿›è¡Œå…·ä½“æ¨¡å‹çš„å­¦ä¹ ã€‚







## 5. Stackingä»£ç å®ç°

```python
from sklearn.model_selection import KFold
from sklearn.neighbors import KNeighborsRegressor
from sklearn.tree import DecisionTreeRegressor
from sklearn.linear_model import LinearRegression
from sklearn.datasets import make_regression
 
import numpy as np
import pandas as pd
 
m1=KNeighborsRegressor()
m2=DecisionTreeRegressor()
m3=LinearRegression()
 
models=[m1,m2,m3]
 
#from sklearn.svm import LinearSVR
 
final_model=DecisionTreeRegressor()
 
k,m=4,len(models)
 
if  __name__=="__main__":
    X,y=make_regression(
        n_samples=1000,n_features=8,n_informative=4,random_state=0
    )
    final_X,final_y=make_regression(
        n_samples=500,n_features=8,n_informative=4,random_state=0
    )
    
    final_train=pd.DataFrame(np.zeros((X.shape[0],m)))
    final_test=pd.DataFrame(np.zeros((final_X.shape[0],m)))
    
    kf=KFold(n_splits=k)
    for model_id in range(m):
        model=models[model_id]
        for train_index,test_index in kf.split(X):
            X_train,X_test=X[train_index],X[test_index]
            y_train,y_test=y[train_index],y[test_index]
            model.fit(X_train,y_train)
            final_train.iloc[test_index,model_id]=model.predict(X_test)
            final_test.iloc[:,model_id]+=model.predict(final_X)
        final_test.iloc[:,model_id]/=k
    final_model.fit(final_train,y)
    res=final_model.predict(final_test)
```

## 6. Blendingä»£ç å®ç°

```python
from sklearn.model_selection import KFold
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsRegressor
from sklearn.tree import DecisionTreeRegressor
from sklearn.linear_model import LinearRegression
from sklearn.datasets import make_regression
 
import numpy as np
import pandas as pd
 
m1=KNeighborsRegressor()
m2=DecisionTreeRegressor()
m3=LinearRegression()
 
models=[m1,m2,m3]
 
final_model=DecisionTreeRegressor()
 
m=len(models)
 
if  __name__=="__main__":
    X,y=make_regression(
        n_samples=1000,n_features=8,n_informative=4,random_state=0
    )
    final_X,final_y=make_regression(
        n_samples=500,n_features=8,n_informative=4,random_state=0
    )
    
 
    X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.5)
    
    final_train=pd.DataFrame(np.zeros((X_test.shape[0],m)))
    final_test=pd.DataFrame(np.zeros((final_X.shape[0],m)))
    
    for model_id in range(m):
        model=models[model_id]
        model.fit(X_train,y_train)
        final_train.iloc[:,model_id]=model.predict(X_test)
        final_test.iloc[:,model_id]+=model.predict(final_X)
        
    final_model.fit(final_train,y_train)
    res=final_model.predict(final_test)
```

